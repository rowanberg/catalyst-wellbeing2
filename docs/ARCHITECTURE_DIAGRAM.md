# CatalystWells Architecture Diagram

## ğŸ—ï¸ Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        catalystwells.com (Root)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  app.catalystwells   â”‚       â”‚ developers.catalyst  â”‚
        â”‚       .com           â”‚       â”‚    wells.com         â”‚
        â”‚  (Main Platform)     â”‚       â”‚ (Developer Portal)   â”‚
        â”‚   Port: 3000         â”‚       â”‚   Port: 4000         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚         â”‚                   â”‚
        â”‚  Supabase DB        â”‚         â”‚  Supabase DB      â”‚
        â”‚  (Main)             â”‚         â”‚  (Developers)     â”‚
        â”‚                     â”‚         â”‚                   â”‚
        â”‚  - profiles         â”‚         â”‚  - dev_accounts   â”‚
        â”‚  - students         â”‚         â”‚  - dev_apps       â”‚
        â”‚  - teachers         â”‚         â”‚  - api_keys       â”‚
        â”‚  - parents          â”‚         â”‚  - webhooks       â”‚
        â”‚  - oauth_apps       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤  - analytics      â”‚
        â”‚  - oauth_tokens     â”‚  Sync   â”‚  - tickets        â”‚
        â”‚                     â”‚         â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ OAuth Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Third-Party App â”‚
â”‚  (Luminex, etc)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1. Redirect to authorize
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  app.catalystwells.com/authsso          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  OAuth Authorization Page         â”‚  â”‚
â”‚  â”‚  - Shows app info (from DB)       â”‚  â”‚
â”‚  â”‚  - Lists requested scopes         â”‚  â”‚
â”‚  â”‚  - User approves/denies           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. Redirect with code
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Third-Party App â”‚
â”‚  /auth/callback  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 3. Exchange code for token
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  app.catalystwells.com/api/oauth/token  â”‚
â”‚  - Validates code                       â”‚
â”‚  - Returns access_token                 â”‚
â”‚  - Returns refresh_token                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 4. Access user data
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  app.catalystwells.com/api/oauth/       â”‚
â”‚  userinfo                                â”‚
â”‚  - Returns user profile                  â”‚
â”‚  - Based on granted scopes               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ‘¨â€ğŸ’» Developer Portal Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Developer      â”‚
â”‚   (New User)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1. Visit portal
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  developers.catalystwells.com           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Landing Page                     â”‚  â”‚
â”‚  â”‚  - Features showcase              â”‚  â”‚
â”‚  â”‚  - Sign up / Sign in              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. Register account
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer Supabase DB                  â”‚
â”‚  - Creates developer_account            â”‚
â”‚  - Sends verification email             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 3. Create application
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  developers.catalystwells.com/dashboard â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Create Application Form          â”‚  â”‚
â”‚  â”‚  - App name, description          â”‚  â”‚
â”‚  â”‚  - Redirect URIs                  â”‚  â”‚
â”‚  â”‚  - Requested scopes               â”‚  â”‚
â”‚  â”‚  - Logo upload                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 4. Submit for review
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin Reviews Application              â”‚
â”‚  (In main app admin panel)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 5. Approve application
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Sync to Main Database                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Developer DB                     â”‚  â”‚
â”‚  â”‚  - Update status: approved        â”‚  â”‚
â”‚  â”‚  - Generate client_id/secret      â”‚  â”‚
â”‚  â”‚                                   â”‚  â”‚
â”‚  â”‚         â†“ Sync â†“                  â”‚  â”‚
â”‚  â”‚                                   â”‚  â”‚
â”‚  â”‚  Main DB                          â”‚  â”‚
â”‚  â”‚  - Insert into oauth_applications â”‚  â”‚
â”‚  â”‚  - App now available for OAuth    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 6. Developer receives credentials
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer       â”‚
â”‚  - client_id     â”‚
â”‚  - client_secret â”‚
â”‚  - Can integrate â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—„ï¸ Database Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Developer Portal DB                      â”‚
â”‚                  (Separate Supabase)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  developer_accounts                                         â”‚
â”‚  â”œâ”€ id, email, name, company                               â”‚
â”‚  â”œâ”€ is_approved, account_status                            â”‚
â”‚  â””â”€ two_factor_enabled                                     â”‚
â”‚                                                             â”‚
â”‚  developer_applications                                     â”‚
â”‚  â”œâ”€ id, developer_id, name                                 â”‚
â”‚  â”œâ”€ client_id, client_secret_hash                          â”‚
â”‚  â”œâ”€ redirect_uris[], allowed_scopes[]                      â”‚
â”‚  â”œâ”€ status (draft/submitted/approved)                      â”‚
â”‚  â””â”€ is_published, is_verified                              â”‚
â”‚                                                             â”‚
â”‚  application_api_keys                                       â”‚
â”‚  â”œâ”€ id, application_id, key_hash                           â”‚
â”‚  â”œâ”€ scopes[], is_active                                    â”‚
â”‚  â””â”€ last_used_at, total_requests                           â”‚
â”‚                                                             â”‚
â”‚  application_webhooks                                       â”‚
â”‚  â”œâ”€ id, application_id, endpoint_url                       â”‚
â”‚  â”œâ”€ secret_hash, events[]                                  â”‚
â”‚  â””â”€ delivery stats                                         â”‚
â”‚                                                             â”‚
â”‚  application_analytics                                      â”‚
â”‚  â”œâ”€ id, application_id, date                               â”‚
â”‚  â”œâ”€ api_requests, authorizations                           â”‚
â”‚  â””â”€ active_users, new_users                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ Sync approved apps
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Main CatalystWells DB                    â”‚
â”‚                  (Main Supabase)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  oauth_applications                                         â”‚
â”‚  â”œâ”€ id, client_id, client_secret                           â”‚
â”‚  â”œâ”€ name, description, logo_url                            â”‚
â”‚  â”œâ”€ redirect_uris[], allowed_scopes[]                      â”‚
â”‚  â””â”€ is_verified, trust_level                               â”‚
â”‚                                                             â”‚
â”‚  oauth_authorization_codes                                  â”‚
â”‚  â”œâ”€ id, code, client_id, user_id                           â”‚
â”‚  â”œâ”€ redirect_uri, scope[]                                  â”‚
â”‚  â””â”€ expires_at, used                                       â”‚
â”‚                                                             â”‚
â”‚  oauth_access_tokens                                        â”‚
â”‚  â”œâ”€ id, token, client_id, user_id                          â”‚
â”‚  â”œâ”€ scope[], expires_at                                    â”‚
â”‚  â””â”€ revoked, last_used_at                                  â”‚
â”‚                                                             â”‚
â”‚  oauth_refresh_tokens                                       â”‚
â”‚  â”œâ”€ id, token, access_token_id                             â”‚
â”‚  â”œâ”€ client_id, user_id                                     â”‚
â”‚  â””â”€ expires_at, revoked                                    â”‚
â”‚                                                             â”‚
â”‚  oauth_user_authorized_apps                                 â”‚
â”‚  â”œâ”€ id, user_id, client_id                                 â”‚
â”‚  â”œâ”€ scopes[], authorization_count                          â”‚
â”‚  â””â”€ first_authorized_at, is_revoked                        â”‚
â”‚                                                             â”‚
â”‚  profiles (Students/Teachers/Parents)                       â”‚
â”‚  â”œâ”€ id, email, role, school_id                             â”‚
â”‚  â””â”€ ... other user data                                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Security Layers                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Layer 1: Network                                           â”‚
â”‚  â”œâ”€ HTTPS/TLS encryption                                   â”‚
â”‚  â”œâ”€ SSL certificates (Vercel)                              â”‚
â”‚  â””â”€ DNS security                                           â”‚
â”‚                                                             â”‚
â”‚  Layer 2: Application                                       â”‚
â”‚  â”œâ”€ CORS policies                                          â”‚
â”‚  â”œâ”€ CSP headers                                            â”‚
â”‚  â”œâ”€ Rate limiting                                          â”‚
â”‚  â””â”€ Input validation                                       â”‚
â”‚                                                             â”‚
â”‚  Layer 3: Authentication                                    â”‚
â”‚  â”œâ”€ Supabase Auth (separate for each)                     â”‚
â”‚  â”œâ”€ JWT tokens                                             â”‚
â”‚  â”œâ”€ 2FA/TOTP (optional)                                    â”‚
â”‚  â””â”€ Session management                                     â”‚
â”‚                                                             â”‚
â”‚  Layer 4: Authorization                                     â”‚
â”‚  â”œâ”€ Row Level Security (RLS)                               â”‚
â”‚  â”œâ”€ Scope-based permissions                                â”‚
â”‚  â”œâ”€ OAuth token validation                                 â”‚
â”‚  â””â”€ API key verification                                   â”‚
â”‚                                                             â”‚
â”‚  Layer 5: Data                                              â”‚
â”‚  â”œâ”€ AES-256-GCM encryption                                 â”‚
â”‚  â”œâ”€ bcrypt password hashing                                â”‚
â”‚  â”œâ”€ API key hashing                                        â”‚
â”‚  â””â”€ Webhook HMAC signatures                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Data Flow

```
User Action â†’ Frontend â†’ API Route â†’ Database â†’ Response

Example: Student views grades
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Student  â”‚â”€â”€â”€â–¶â”‚ Next.js  â”‚â”€â”€â”€â–¶â”‚ Supabase â”‚â”€â”€â”€â–¶â”‚ Database â”‚
â”‚ Browser  â”‚â—€â”€â”€â”€â”‚ API      â”‚â—€â”€â”€â”€â”‚ Client   â”‚â—€â”€â”€â”€â”‚ (RLS)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚               â”‚                â”‚                â”‚
    â”‚ GET /grades   â”‚                â”‚                â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                â”‚                â”‚
    â”‚               â”‚ Auth check     â”‚                â”‚
    â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                â”‚
    â”‚               â”‚                â”‚ SELECT grades  â”‚
    â”‚               â”‚                â”‚ WHERE user_id  â”‚
    â”‚               â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚               â”‚                â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚               â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                â”‚
    â”‚ JSON response â”‚                â”‚                â”‚
```

---

**This diagram shows the complete architecture of CatalystWells with proper domain separation and security layers.**
