# ============================================
# Catalyst Wells Environment Variables Template
# ============================================
# Copy this file to .env.local and fill in your values
# NEVER commit .env.local to version control
# ============================================

# ============================================
# REQUIRED: Supabase Configuration
# ============================================
# Get these from your Supabase project dashboard
NEXT_PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# ============================================
# REQUIRED: Security Keys
# ============================================
# Generate a strong random key (minimum 32 characters)
# You can use: openssl rand -hex 32
SUPER_ADMIN_SECRET_KEY=generate-random-32-char-minimum-key-here

# ============================================
# Application Configuration
# ============================================
# Environment: development | test | production
NEXT_PUBLIC_APP_ENV=development

# Your application URL
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# ============================================
# Optional: AI Features (Gemini)
# ============================================
# Get your API key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your-gemini-api-key-here

# For encrypted API key management (exam question generation)
# Must match the key used to encrypt API keys in gemini_25_flash_keys table
# Generate with: openssl rand -hex 32
API_KEY_ENCRYPTION_KEY=your-32-char-encryption-key-here

# ============================================
# REQUIRED: Student Data Encryption Key (AES-256)
# ============================================
# Used to encrypt sensitive student data (guardian info, emergency contacts, medical notes)
# CRITICAL: Generate a secure 32-byte (64 hex character) key
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# OR: openssl rand -hex 32
# 
# WARNING: If you lose this key, encrypted data cannot be recovered!
# Store a backup securely (password manager, HSM, etc.)
STUDENT_INFO_ENCRYPTION_KEY=your-64-hex-char-encryption-key-here

# ============================================
# Performance: Upstash Redis Cache (REQUIRED for Production)
# ============================================
# We use FOUR separate Upstash Redis instances for higher limits:
# 1. Grades Redis - For grade levels caching
# 2. School Redis - For school configuration caching (teachers only)
# 3. Teachers Redis - For teacher class assignments caching
# 4. Rosters Redis - For class roster/student lists caching
#
# Sign up at: https://upstash.com/
# Create FOUR separate Redis databases
# Each gets 10K commands/day on free tier = 40K total!
#
# Benefits:
# - 99.4% faster API responses (858ms → 5ms for grades)
# - 99.3% faster school info (300-800ms → 5-20ms)
# - 97% faster class assignments (200-500ms → 5-15ms)
# - 99% faster class rosters (500-1500ms → 5-20ms)
# - 95%+ reduction in database load
# - Separate quotas for different data types
# - Isolated invalidation per class/teacher
# 
# ============================================
# Redis Instance 1: GRADE LEVELS CACHE
# ============================================
# Used by: /api/teacher/grades, /api/teacher/grade-levels
# TTL: 10 days (invalidated by admin when grade levels change)
# Users: Teachers, Students (grade selection dropdowns)
# 
# Setup:
# 1. Create account at https://console.upstash.com
# 2. Create new Redis database named "catalyst-grades"
# 3. Choose region closest to your app
# 4. Go to "REST API" tab
# 5. Copy UPSTASH_REDIS_REST_URL and UPSTASH_REDIS_REST_TOKEN
UPSTASH_REDIS_URL=https://your-grades-redis.upstash.io
UPSTASH_REDIS_TOKEN=your-grades-redis-token-here

# ============================================
# Redis Instance 2: SCHOOL CONFIGURATION CACHE
# ============================================
# Used by: /api/teacher/school-info (teachers only)
# TTL: 15 days (admin invalidates on updates)
# Users: Teachers only (students don't access this data)
# 
# Setup:
# 1. In same Upstash account, create SECOND database
# 2. Name it "catalyst-school"
# 3. Choose same region as grades Redis
# 4. Go to "REST API" tab
# 5. Copy credentials below
UPSTASH_REDIS_SCHOOL_URL=https://your-school-redis.upstash.io
UPSTASH_REDIS_SCHOOL_TOKEN=your-school-redis-token-here

# ============================================
# Redis Instance 3: TEACHER CLASS ASSIGNMENTS CACHE
# ============================================
# Used by: /api/teacher/class-assignments (teachers only)
# TTL: 15 days (invalidated on assignment changes)
# Users: Teachers only (each teacher's cache is isolated)
# 
# CRITICAL: Cache is per-teacher, not shared
# - Teacher A's assignments cached separately from Teacher B
# - Invalidation only affects the specific teacher who made changes
# - Prevents cache pollution between teachers
# 
# Setup:
# 1. In same Upstash account, create THIRD database
# 2. Name it "catalyst-teachers"
# 3. Choose same region as other Redis instances
# 4. Go to "REST API" tab
# 5. Copy credentials below
UPSTASH_REDIS_TEACHERS_URL=https://your-teachers-redis.upstash.io
UPSTASH_REDIS_TEACHERS_TOKEN=your-teachers-redis-token-here

# ============================================
# Redis Instance 4: CLASS ROSTERS CACHE
# ============================================
# Used by: /api/teacher/students (teachers only)
# TTL: 20 days (invalidated on enrollment changes)
# Users: Teachers accessing student lists per class
# 
# CRITICAL: Cache is per-class, not per-teacher
# - Class A roster cached separately from Class B
# - Invalidation triggered when student registers/enrolls
# - Multiple teachers can share same class roster cache
# - Cache invalidated when student joins during registration
# 
# Called from 7+ places in teacher dashboard:
# - Attendance page
# - Issue credits page (2x calls!)
# - Shout-outs system
# - Update results system
# - Black mark system
# - Attendance system component
# - Grade-based roster
# 
# Auto-invalidation triggers:
# - Student registers via /register (invalidates their class)
# - Student enrollment changes
# - Student profile updates
# 
# Setup:
# 1. In same Upstash account, create FOURTH database
# 2. Name it "catalyst-rosters"
# 3. Choose same region as other Redis instances
# 4. Go to "REST API" tab
# 5. Copy credentials below
UPSTASH_REDIS_ROSTERS_URL=https://your-rosters-redis.upstash.io
UPSTASH_REDIS_ROSTERS_TOKEN=your-rosters-redis-token-here

# ============================================
# Redis Instance 5: PARENT PORTAL CACHE
# ============================================
# Used by: /api/v1/parents/* (all parent portal endpoints)
# TTL: 15 days (invalidated on data changes)
# Users: Parents accessing dashboard, analytics, community
# 
# CRITICAL: Single Redis for all parent data
# - Parent settings (profile + children list)
# - Student dashboard data (grades, attendance, mood)
# - Student analytics (GPA trends, benchmarks)
# - Community feed (school announcements)
# 
# Two-tier caching:
# - Local memory cache (5-30 min) = 0ms latency
# - Redis cache (15 days) = 50-100ms latency
# 
# Performance impact:
# - Settings API: 5.5s → 50ms (110x faster)
# - Dashboard API: 7.0s → 80ms (87x faster)
# - Analytics API: 3.2s → 60ms (53x faster)
# - Community feed: 2.5s → 40ms (62x faster)
# 
# Setup:
# 1. In same Upstash account, create FIFTH database
# 2. Name it "catalyst-parents"
# 3. Choose same region as other Redis instances
# 4. Go to "REST API" tab
# 5. Copy credentials below
UPSTASH_REDIS_PARENTS_URL=https://your-parents-redis.upstash.io
UPSTASH_REDIS_PARENTS_TOKEN=your-parents-redis-token-here

# ============================================
# REQUIRED: Email Service (SendGrid)
# ============================================
# Get your API key from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=your-sendgrid-api-key-here
SENDGRID_FROM_EMAIL=noreply@catalystwells.com
# Optional: Custom from name
SENDGRID_FROM_NAME=Catalyst Wellbeing

# ============================================
# OTP EMAIL VERIFICATION (TurboSMTP)
# ============================================
# For email OTP verification during registration
# Get credentials from: https://www.serversmtp.com
TURBO_SMTP_USER=your-turbo-smtp-username
TURBO_SMTP_PASS=your-turbo-smtp-password
TURBO_SMTP_HOST=pro.turbo-smtp.com
TURBO_SMTP_PORT=465
TURBO_SMTP_FROM=no-reply@catalystwells.in

# Application URL (used in email templates)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ============================================
# Optional: Analytics
# ============================================
# Google Analytics or other tracking
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX

# ============================================
# Development Only
# ============================================
# Set to true to enable debug logging
DEBUG_MODE=false

# Set to true for emergency lockdown
EMERGENCY_LOCKDOWN=false

# ============================================
# Security Notes:
# ============================================
# 1. NEVER commit this file with real values
# 2. Use different keys for each environment
# 3. Rotate keys regularly (monthly recommended)
# 4. Keep service role key server-side only
# 5. Use strong, random keys (no dictionary words)
# ============================================
